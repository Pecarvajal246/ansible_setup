---
- hosts: localhost
  connection: local
  become: true

  tasks:
    - name: Enable the RPM Fusion repository
      dnf:
        name:
          - "https://mirrors.rpmfusion.org/free/fedora/rpmfusion-free-release-{{ansible_distribution_major_version}}.noarch.rpm"
          - "https://mirrors.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-{{ansible_distribution_major_version}}.noarch.rpm"
        state: present
        disable_gpg_check: True
      when: ansible_distribution == 'Fedora'

    - name: Enable CORPS
      community.general.copr:
        state: enabled
        name:
          - peterwu/iosevka
          - griffis/neovim-nightly

    - name: install packages
      package:
        name:
          - stow
          - rofi
          - awesome
          - mpv
          - sxhkd
          - picom
          - nitrogen
          - kitty
          - streamlink
          - iosevka
          - neovim-nightly

    - name: dotfiles
      become: true
      become_user: pedro
      git:
        repo: https://github.com/Pecarvajal246/.dotfiles.git
        dest: "{{ ansible_env.HOME }}"
        clone: yes

    - name: stow dotfiles
      command: chdir="{{ ansible_env.HOME }}/.dotfiles stow ."
