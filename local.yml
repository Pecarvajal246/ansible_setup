---
- hosts: localhost
  connection: local
  become: true

  tasks:
    - name: Enable the RPM Fusion repository
      dnf:
        name:
          - "https://mirrors.rpmfusion.org/free/fedora/rpmfusion-free-release-{{ansible_distribution_major_version}}.noarch.rpm"
          - "https://mirrors.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-{{ansible_distribution_major_version}}.noarch.rpm"
        state: present
        disable_gpg_check: True
      when: ansible_distribution == 'Fedora'

    - name: Enable iosevka CORPS
      community.general.copr:
        state: enabled
        name: peterwu/iosevka

    - name: Enable neovim-nightly CORPS
      community.general.copr:
        state: enabled
        name: agriffis/neovim-nightly

    - name: install packages
      package:
        name:
          - stow
          - rofi
          - awesome
          - mpv
          - sxhkd
          - picom
          - nitrogen
          - kitty
          - fish
          - streamlink
          - iosevka-fonts
          - neovim

    - name: dotfiles
      become_user: pedro
      git:
        repo: https://github.com/Pecarvajal246/.dotfiles.git
        dest: /home/pedro/.dotfiles/
        clone: yes

    - name: remove old bashrc
      file:
        path: /home/pedro/.bashrc
        state: absent

    - name: remove old profile
      file:
        path: /home/pedro/.profile
        state: absent

    - name: stow dotfiles
      shell:
        chdir: /home/pedro/.dotfiles/
        cmd: stow *
